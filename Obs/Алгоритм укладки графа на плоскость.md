## Алгоритм укладки графа на плоскость
Только к [[Двусвязный граф,характеризация двусвязных графов]]!

##### Определения
Пусть $\overline{G}$ - частичная укладка [[Граф]] $G$.

**Сегмент** $S$ - ребро $e = xy: x,y \in V\overline{G}, e \notin E\overline{G}, e \in EG$
2. [[Компонента связности]] графа $G - V\overline{G}$ с добавленными ребрами из этой компоненты связности в $\overline{G}$

Сегменты $S_1$ и $S_2$ - **конфликтующие**, если
1. $\Gamma(S_1) \cap \Gamma(S_2) \not= \emptyset$
2. $\exists$ $\alpha$-цепи $e_1, e_2$ в $S_1, S_2$ соответственно, которые нельзя одновременно уложить ни в какую грань из $\Gamma(S_1) \cap \Gamma(S_2)$.

 $S(\overline{G})$ - **[[Граф]] конфликтов**. Вершины - сегменты относительно $\overline{G}$ и ребро, если эти сегменты конфликтуют.

**Контактная вершина** - вершина находящаяся и в сегменте, и в частично уложенном графе, принадлежащие сегменту.

**Допустимая [[Грань плоского графа|грань]]** $\Gamma$ сегмента $S$ относительно $\overline{G}$, если все контактные вершины $S$ лежат на границе $\Gamma$.

$\Gamma(S)$ - множество допустимых граней для $S$

[[Простая цепь]] сегмента $S$, концы которой являются контактными и других контактых вершин не содержит называется **$\alpha$-цепь**

#### Алгоритм
1. Выбираем простую цепь $C$, $\overline{G} := C$
2. Грани $\overline{G}$. Сегменты относительно $\overline{G}$. Если сегментов нет, то $\overline{G} = G$
3. $\forall S$ определяем $\Gamma(S)$. Если существует $S: \Gamma(S) = \emptyset$, то граф не планарный, конец. Если существует $S: |\Gamma(S)|=1$, то выбираем $S$. Иначе выбираем произвольный в $S$.
4. Выбираем $\alpha$-цепь в $S$ и укладываем в допустимую грань.
5. $\overline{G} = \overline{G} +$$\alpha$-цепь.
6. goto 2.

#### Обоснование
##### Лемма
Если 2 сегмента конфликтуют: $|\Gamma(S_1)| \ge 2$,$|\Gamma(S_2)| \ge 2 \implies \Gamma(S_1) = \Gamma(S_2), |\Gamma(S_1) = 2$

###### Доказательство.
 Пусть $\Gamma(S_1) \not= \Gamma(S_2)$ 
 Тогда существуют три разных грани $\Gamma_1 \in \Gamma(S_1), \Gamma_2 \in \Gamma(S_2), \Gamma_3 \in \Gamma(S_1 \cap S_2)$. Любая $\alpha$-цепь укладывается в $\Gamma_1$, любая $\alpha$-цепь укладывается в $\Gamma_2$, одновременно укладываются в эти грани, но тогда они укладываются и в $\Gamma_3$ ([[Теорема о внешней грани]]), противоречие.
 
 Аналогично доказывается, что $|\Gamma_1(S_1)| = 2$
 
 ##### Лемма
 Если после укладки $\alpha$-цепи получили частичную укладку графа $G$, такую, что $|\Gamma(S_i)| \ge 2$, тогда $S(\overline{G})$ - двудольный.
 
###### Доказательство
Пусть $S_1, S_2, \ldots, S_t, S_1$ - простой цикл в $(\overline{G})$. По лемме выше $\Gamma(S_i) = \{\Gamma_1, \Gamma_2\}$.
Т.к. $\overline{G}$ - частичная укладка, в укладке $G$ уложится в одну из $\Gamma_1$ или $\Gamma_2$.
Тогда $S_2$ в другую, $S_3$ в первую и т.д. чередуясь. $\implies t$  - четно. По [[Двудольность, критерий двудольности (Кёнинга)]] ч.т.д.

##### Теорема (обоснование)
Если $G$ - [[Планарный граф, плоский граф]], то после укладки всякой $\alpha$-цепи получим частичную укладку графа $G$.

###### Доказательство
Индукция по числу шагов (укладок $\alpha$-цепей).

**База:** $C$ - частичная укладка.
**Шаг:** Пусть $\overline{G}$ - частичная укладка, укладываем $l - \alpha$-цепь, $\overline{G} \cup l$ - тоже частичная укладка.
Т.к. $\overline{G}$ - частичная укладка, то $\forall S$ - сегмент относительно $\overline{G}$ $\Gamma(S) \not=\emptyset$
Если $\exists S: \Gamma(S) = \{|Gamma_i\} \implies$ в укладке $G'$(укладка графа $G$ из которой полученно $\overline{G}$) $S$ уложен в  $\Gamma_i \implies$ укладка $\alpha$-цепи из $S$ в $\Gamma_i$ дает частичную укладку графа $G$.
Пусть $|\Gamma(S_i)| \ge 2$, то рассмотрим граф $S(\overline{G})$. По лемме выше он двудольный. Если $S$ - изолированная вершина $S(\overline{G})$, тогда $S$ не конфликтует и укладка $\alpha$-цепи приводит к частичной укладке графа $G$. 
Пусть $H$ - компонента связности графа $S(\overline{G})$, не являющаяся изолированной вершиной. $\{S_1, \ldots, S_t\} = VH$. $\Gamma(S_i) = \{\Gamma_1, \Gamma_2\}$.  Пусть алгоритм выбрал $S_1$ и уложил $\alpha$-цепь в $\Gamma_1$. Если в $G'$ $S_1$ уложен в $\Gamma_1$, то получаем частичную укладку. Если в $G'\ S$ уложен в $\Gamma_2$. Тогда все сегменты из одной доли $H$ уложены в $\Gamma_1$, из другой в $\Gamma_2$. Поменяем их местами. Получим граф $G''$. $\overline{G} \cup l$ - подграф $G''$ - частичная укладка.
 
 